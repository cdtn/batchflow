

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Dataset &mdash; BatchFlow 0.3.5 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Batch" href="batchflow.batch.html" />
    <link rel="prev" title="Index" href="batchflow.index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> BatchFlow
          

          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">A short introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro/classes.html">Classes and capabilities</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="batchflow.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="batchflow.core.html">batchflow</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="batchflow.index.html">Index</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Dataset</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.batch.html">Batch</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.batch_image.html">ImagesBatch</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.pipeline.html">Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.once_pipeline.html">Once pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.named_expressions.html">Named expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.sampler.html">Sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.decorators.html">Decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="batchflow.exceptions.html">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="batchflow.opensets.html">batchflow.opensets</a></li>
<li class="toctree-l2"><a class="reference internal" href="batchflow.models.html">batchflow.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="batchflow.research.html">batchflow.research</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BatchFlow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="batchflow.html">API</a> &raquo;</li>
        
          <li><a href="batchflow.core.html">batchflow</a> &raquo;</li>
        
      <li>Dataset</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/batchflow.dataset.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dataset">
<h1>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<dl class="py class">
<dt id="batchflow.Dataset">
<em class="property">class </em><code class="sig-name descname">Dataset</code><span class="sig-paren">(</span><em class="sig-param">index</em>, <em class="sig-param">batch_class=&lt;class 'batchflow.batch.Batch'&gt;</em>, <em class="sig-param">*args</em>, <em class="sig-param">preloaded=None</em>, <em class="sig-param">cast_to_array=True</em>, <em class="sig-param">copy=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>The Dataset holds an index of all data items
(e.g. customers, transactions, etc)
and a specific action class to process a small subset of data (batch).</p>
<dl class="py attribute">
<dt id="batchflow.Dataset.batch_class">
<code class="sig-name descname">batch_class</code><a class="headerlink" href="#batchflow.Dataset.batch_class" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="batchflow.batch.html#batchflow.Batch" title="batchflow.Batch">Batch</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="batchflow.Dataset.index">
<code class="sig-name descname">index</code><a class="headerlink" href="#batchflow.Dataset.index" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="batchflow.index.html#batchflow.DatasetIndex" title="batchflow.DatasetIndex">DatasetIndex</a> or <a class="reference internal" href="batchflow.index.html#batchflow.FilesIndex" title="batchflow.FilesIndex">FilesIndex</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="batchflow.Dataset.indices">
<code class="sig-name descname">indices</code><a class="headerlink" href="#batchflow.Dataset.indices" title="Permalink to this definition">¶</a></dt>
<dd><p>an array with the indices</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>class:<cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="batchflow.Dataset.p">
<code class="sig-name descname">p</code><a class="headerlink" href="#batchflow.Dataset.p" title="Permalink to this definition">¶</a></dt>
<dd><p>Actions which will be applied to this dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="batchflow.pipeline.html#batchflow.Pipeline" title="batchflow.Pipeline">Pipeline</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="batchflow.Dataset.preloaded">
<code class="sig-name descname">preloaded</code><a class="headerlink" href="#batchflow.Dataset.preloaded" title="Permalink to this definition">¶</a></dt>
<dd><p>For small dataset it could be convenient to preload data at first</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>data-type</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="batchflow.Dataset.train">
<code class="sig-name descname">train</code><a class="headerlink" href="#batchflow.Dataset.train" title="Permalink to this definition">¶</a></dt>
<dd><p>The train part of this dataset. It appears after splitting</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#batchflow.Dataset" title="batchflow.Dataset">Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="batchflow.Dataset.test">
<code class="sig-name descname">test</code><a class="headerlink" href="#batchflow.Dataset.test" title="Permalink to this definition">¶</a></dt>
<dd><p>The test part of this dataset. It appears after splitting</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#batchflow.Dataset" title="batchflow.Dataset">Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="batchflow.Dataset.validation">
<code class="sig-name descname">validation</code><a class="headerlink" href="#batchflow.Dataset.validation" title="Permalink to this definition">¶</a></dt>
<dd><p>The validation part of this dataset. It appears after splitting</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#batchflow.Dataset" title="batchflow.Dataset">Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.CV">
<code class="sig-name descname">CV</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.CV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.CV" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dataset which corresponds to the fold defined as NamedExpression</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.build_index">
<em class="property">static </em><code class="sig-name descname">build_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.build_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.build_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if instance of the index is DatasetIndex
if it is not - create DatasetIndex from inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<a class="reference internal" href="batchflow.index.html#batchflow.DatasetIndex" title="batchflow.DatasetIndex"><em>DatasetIndex</em></a><em> or </em><em>any</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="batchflow.index.html#batchflow.DatasetIndex" title="batchflow.DatasetIndex">DatasetIndex</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.calc_split">
<code class="sig-name descname">calc_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shares</span><span class="o">=</span><span class="default_value">0.8</span></em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.Dataset.calc_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate split into train, test and validation subsets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shares</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em> or </em><em>a sequence of floats</em>) – A share of train, test and validation subset respectively.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>a tuple which contains number of items in train, test and validation subsets</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – <ul class="simple">
<li><p>if shares has more than 3 items
    * if sum of shares is greater than 1
    * if this set does not have enough items to split</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Split into train / test in 80/20 ratio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">some_set</span><span class="o">.</span><span class="n">calc_split</span><span class="p">()</span>
</pre></div>
</div>
<p>Split into train / test / validation in 60/30/10 ratio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">some_set</span><span class="o">.</span><span class="n">calc_split</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
</pre></div>
</div>
<p>Split into train / test / validation in 50/30/20 ratio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">some_set</span><span class="o">.</span><span class="n">calc_split</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a shallow copy of the dataset object</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.create_attrs">
<code class="sig-name descname">create_attrs</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.create_attrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.create_attrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create attributes from kwargs</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.create_batch">
<code class="sig-name descname">create_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">pos</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.create_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.create_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a batch from given indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<a class="reference internal" href="batchflow.index.html#batchflow.DatasetIndex" title="batchflow.DatasetIndex"><em>DatasetIndex</em></a>) – Indices of dataset objects that should be included into batch</p></li>
<li><p><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Whether <cite>index</cite> contains elements positions. Defaults to False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="batchflow.batch.html#batchflow.Batch" title="batchflow.Batch">Batch</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <cite>pos</cite> is <cite>False</cite>, then <cite>index</cite> should contain the indices
that should be included in the batch, otherwise <cite>index</cite>
should contain their positions in current index.</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.create_subset">
<code class="sig-name descname">create_subset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.create_subset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.create_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a dataset based on the given subset of indices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<a class="reference internal" href="batchflow.index.html#batchflow.DatasetIndex" title="batchflow.DatasetIndex"><em>DatasetIndex</em></a><em> or </em><em>np.array</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#batchflow.Dataset" title="batchflow.Dataset">Dataset</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IndexError" title="(in Python v3.9)"><strong>IndexError</strong></a> – When a user wants to create a subset from source dataset it is necessary to be confident
    that the index of new subset lies in the range of source dataset’s index.
    If the index lies out of the source dataset index’s range, the IndexError is raised.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.cv">
<code class="sig-name descname">cv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.cv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dataset which corresponds to n-th CV split</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.cv_split">
<code class="sig-name descname">cv_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'kfold'</span></em>, <em class="sig-param"><span class="n">n_splits</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.cv_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.cv_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Create datasets for cross-validation</p>
<p>Datasets are available as <cite>cv0</cite>, <cite>cv1</cite> and so on. And they are already split into train and test parts.</p>
<p>Another way to access these splits is <cite>train.cv0</cite>, <cite>train.cv1</cite>, …, <cite>test.cv0</cite>, <cite>test.cv1</cite>, …</p>
<p>Note that each pair (e.g. <cite>cv0.train</cite> and <cite>train.cv0</cite>) refers to the very same instance of a dataset,
i.e. if you change <cite>train.cv0</cite>, <cite>cv0.train</cite> will also change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>{'kfold'}</em>) – a splitting method (only <cite>kfold</cite> is supported)</p></li>
<li><p><strong>n_splits</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – a number of folds</p></li>
<li><p><strong>shuffle</strong> (bool, int, class:<cite>numpy.random.RandomState</cite> or callable) – <p>specifies the order of items, could be:</p>
<ul>
<li><dl class="simple">
<dt>bool - if <cite>False</cite>, items go sequentionally, one after another as they appear in the index.</dt><dd><p>if <cite>True</cite>, items are shuffled randomly before each epoch.</p>
</dd>
</dl>
</li>
<li><p>int - a seed number for a random shuffle.</p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code></a> instance.</p></li>
<li><dl class="simple">
<dt>callable - a function which takes an array of item indices in the initial order</dt><dd><p>(as they appear in the index) and returns the order of items.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">cv_split</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">cv0</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span> <span class="c1"># [0, 1, 2, 3]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">cv1</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span> <span class="c1"># [4, 5, 6]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">cv2</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span> <span class="c1"># [7, 8, 9]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">cv0</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span> <span class="c1"># [0, 1, 2, 3]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">cv1</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span> <span class="c1"># [4, 5, 6]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">cv2</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span> <span class="c1"># [7, 8, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#batchflow.Dataset.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Return preloaded data</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.from_dataset">
<em class="property">classmethod </em><code class="sig-name descname">from_dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">index</span></em>, <em class="sig-param"><span class="n">batch_class</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.from_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.from_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a Dataset object from another dataset with a new index
(usually a subset of the source dataset index)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<a class="reference internal" href="#batchflow.Dataset" title="batchflow.Dataset"><em>Dataset</em></a>) – Source dataset</p></li>
<li><p><strong>index</strong> (<a class="reference internal" href="batchflow.index.html#batchflow.DatasetIndex" title="batchflow.DatasetIndex"><em>DatasetIndex</em></a>) – Set of items from source dataset which should be in the new Dataset</p></li>
<li><p><strong>batch_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – a subclass of Batch class</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – whether to create a copy of the dataset or use the same instance wherever possible</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#batchflow.Dataset" title="batchflow.Dataset">Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.gen_batch">
<code class="sig-name descname">gen_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">n_iters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_epochs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">drop_last</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">notifier</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.Dataset.gen_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate batches</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.get_attrs">
<code class="sig-name descname">get_attrs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.get_attrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.get_attrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return additional attrs as kwargs</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.get_default_iter_params">
<em class="property">classmethod </em><code class="sig-name descname">get_default_iter_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.Dataset.get_default_iter_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return iteration params with default values to start iteration from scratch</p>
</dd></dl>

<dl class="py method">
<dt id="id0">
<em class="property">property </em><code class="sig-name descname">index</code><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>the dataset’s index</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dataset.DatasetIndex</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id1">
<em class="property">property </em><code class="sig-name descname">indices</code><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>an array with the indices</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.is_split">
<em class="property">property </em><code class="sig-name descname">is_split</code><a class="headerlink" href="#batchflow.Dataset.is_split" title="Permalink to this definition">¶</a></dt>
<dd><p>True if dataset has been split into train / test / validation subsets</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.next_batch">
<code class="sig-name descname">next_batch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">n_iters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_epochs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">drop_last</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">iter_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.Dataset.next_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a batch</p>
</dd></dl>

<dl class="py method">
<dt id="id2">
<em class="property">property </em><code class="sig-name descname">p</code><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><p>A short alias for <cite>pipeline()</cite></p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.pipeline">
<code class="sig-name descname">pipeline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/dataset.html#Dataset.pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.Dataset.pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Start a new data processing workflow</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<em>Config</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Config lets you initialize variables in the Pipeline object, e.g. for the augmentation task
<a class="reference external" href="https://analysiscenter.github.io/batchflow/intro/pipeline.html#initializing-a-variable">https://analysiscenter.github.io/batchflow/intro/pipeline.html#initializing-a-variable</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="batchflow.pipeline.html#batchflow.Pipeline" title="batchflow.Pipeline">Pipeline</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">what</span><span class="o">=</span><span class="default_value">'iter'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.Dataset.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all iteration metadata in order to start iterating from scratch</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.reset_iter">
<code class="sig-name descname">reset_iter</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.Dataset.reset_iter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.size">
<em class="property">property </em><code class="sig-name descname">size</code><a class="headerlink" href="#batchflow.Dataset.size" title="Permalink to this definition">¶</a></dt>
<dd><p>int - number of items in the set</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.Dataset.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shares</span><span class="o">=</span><span class="default_value">0.8</span></em>, <em class="sig-param"><span class="n">shuffle</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.Dataset.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the dataset into train, test and validation sub-datasets.
Subsets are available as <cite>.train</cite>, <cite>.test</cite> and <cite>.validation</cite> respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shares</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>tuple of 2 floats</em><em>, or </em><em>tuple of 3 floats</em>) – train/test/validation shares. Default is 0.8.</p></li>
<li><p><strong>shuffle</strong> (bool, <a class="reference external" href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code></a>, int or callable) – <p>whether to randomize items order before splitting into subsets. Default is <cite>False</cite>. Can be</p>
<ul>
<li><dl>
<dt><cite>bool</cite><span class="classifier"><cite>False</cite> - to make subsets in the order of indices in the index,</span></dt><dd><p><cite>True</cite> - to make random subsets.</p>
</dd>
</dl>
</li>
<li><p>a <a class="reference external" href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code></a> object which has an inplace shuffle method.</p></li>
<li><dl class="simple">
<dt><cite>int</cite> - a random seed number which will be used internally to create</dt><dd><p>a <a class="reference external" href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" title="(in NumPy v1.19)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code></a> object.</p>
</dd>
</dl>
</li>
<li><p>callable - a function which gets an order and returns a shuffled order.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Split into train / test in 80/20 ratio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>
</div>
<p>Split into train / test / validation in 60/30/10 ratio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">split</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
</pre></div>
</div>
<p>Split into train / test / validation in 50/30/20 ratio</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span><span class="o">.</span><span class="n">split</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="batchflow.batch.html" class="btn btn-neutral float-right" title="Batch" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="batchflow.index.html" class="btn btn-neutral float-left" title="Index" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2017-2019, Analysis Center

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>